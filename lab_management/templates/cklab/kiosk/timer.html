{% extends 'cklab/base.html' %}
{% load static %}

{% block title %}กำลังใช้งาน - Station {{ computer.name|default:"Unknown" }}{% endblock %}

{% block extra_head %}
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
    /* บังคับให้หน้านี้มีพื้นหลังสีเข้ม (Dark Mode) เพื่อให้ตรงกับดีไซน์เดิม */
    body {
        background-color: #212529 !important; /* เทียบเท่า bg-dark ของ Bootstrap */
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex align-items-center justify-content-center min-vh-100 text-white">
    <div class="text-center w-100" style="max-width: 600px;">
        
        <h5 class="text-white-50 mb-3">ผู้ใช้งานปัจจุบัน</h5>
        <h2 id="userNameDisplay" class="text-warning mb-4 fw-bold">-</h2>
        
        <div class="card bg-secondary bg-opacity-25 border-secondary p-5 mb-4 rounded-4 shadow-lg position-relative overflow-hidden">
            <h1 class="display-1 fw-bold mb-0 text-white" id="timerDisplay">00:00:00</h1>
            <small class="text-white-50 mt-2 d-block" id="timerLabel">ระยะเวลาที่ใช้งาน (Usage Time)</small>
            
            <div id="alertBox" class="alert alert-warning mt-3 mb-0 d-none text-start animate-fade">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <span id="alertMsg">แจ้งเตือน...</span>
            </div>
        </div>

        <h4 class="mb-4">
            <span class="badge bg-primary px-4 py-2" id="pcNameDisplay">Station: {{ computer.name|default:"-" }}</span>
        </h4>

        <div class="d-grid gap-3 d-sm-flex justify-content-center">
            <form id="checkoutForm" method="POST" action="/kiosk/checkout/{{ computer.name }}/">
                {% csrf_token %}
                <button type="button" onclick="doCheckout()" class="btn btn-danger btn-lg px-4 rounded-pill fw-bold shadow">
                    <i class="bi bi-box-arrow-right me-2"></i>เลิกใช้งาน (Check-out)
                </button>
            </form>
        </div>
        
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    const PC_ID = "{{ computer.name|default:'' }}";
</script>

<script src="{% static 'cklab/js/timer.js' %}"></script>
{% endblock %}